    - name: Generate SmartNews Feed
      run: |
        python - <<'EOF'
        import requests
        from bs4 import BeautifulSoup
        from feedgen.feed import FeedGenerator
        from datetime import datetime
        from dateutil import parser

        source_url = "https://rss.app/feeds/PnXLTXpDQSdLv1cb.xml"
        xml = requests.get(source_url).text
        soup = BeautifulSoup(xml, "xml")

        fg = FeedGenerator()
        fg.load_extension('media')
        fg.load_extension('content')

        fg.title("Entertainment News")
        fg.link(href="https://www.cabletv.com/blog/category/entertainment", rel="alternate")
        fg.description("Let's start watching! CableTV.com keeps you informed of all entertainment news.")
        fg.logo("https://i.ibb.co/sptKgp34/CTV-Feed-Logo.png")

        for item in soup.find_all("item"):
            title = item.title.text if item.title else ""
            link = item.link.text if item.link else ""
            description = item.description.text if item.description else ""
            author = item.findtext("dc:creator") or item.findtext("author")
            pub_date_raw = item.findtext("pubDate") or item.findtext("dc:date")
            try:
                pub_date = parser.parse(pub_date_raw).strftime('%a, %d %b %Y %H:%M:%S GMT')
            except Exception:
                pub_date = datetime.utcnow().strftime('%a, %d %b %Y %H:%M:%S GMT')

            img = ""
            if item.find("media:content"):
                img = item.find("media:content").get("url", "")
            elif item.find("enclosure"):
                img = item.find("enclosure").get("url", "")

            fe = fg.add_item()
            fe.title(title)
            fe.link(href=link)
            fe.description(description)
            fe.author({"name": author})
            fe.pubDate(pub_date)
            if img:
                fe.enclosure(url=img, type="image/jpeg")
                fe.media.thumbnail(url=img)
            fe.content(content=description, type='CDATA')

        fg.rss_file("feed.xml")
        EOF
